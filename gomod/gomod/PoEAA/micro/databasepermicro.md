# Database per Microservice
## [<<< ---](../micro.md)
![image.png](databasepermicro/image.png)

Разные сервисы предъявляют разные требования к хранению данных. Для некоторых сервисов реляционная база данных является лучшим выбором. Другим сервисам может потребоваться база данных NoSQL, такая как MongoDB, которая хороша для хранения сложных неструктурированных данных, или Neo4J, которая предназначена для эффективного хранения и запроса данных в формате графа.

Одной из основных характеристик архитектуры микросервисов является слабая связанность сервисов . По этой причине каждый сервис должен иметь свои собственные базы данных.

Основная идея **database per service pattern** - микросервисы не имет доступа к базе соседних сервисов и обращаются между собой средством REST, или через меседж брокер. Таким образом наши микросервисы становятся действительно независимыми от стореджа и могут разрабатываться параллельно.

## Преимущества и недостатками Database per service

### Преимущества:

- Слабая связанность сервисов. Изминения в бд одного сервиса не влияют на другие сервисы как при [**Shared database**](Shared%20database%2050f167614aad4ce28f3a5355b616dfda.md) .
- Каждый сервис может использовать тот тип БД который подходит лучше для его нужд. Например один сервис может использовать Elastic поиск, второй NoSQL, третий SQL, если этого требует бизнес логика и NFR.

### Недостатки:

- Реализация бизнес-транзакций, охватывающих несколько сервисов, довольно комплексное задание. Распределенных транзакций лучше избегать из-за CAP теоремы. Более того, многие современные (NoSQL) базы данных их не поддерживают.
- Реализация запросов, которые джоинит данные с разных баз данных, не тривиальная задача.
- Сложность управления несколькими базами данных SQL и NoSQL.

Существуют различные шаблоны/решения для реализации транзакций и запросов для микросервисной архитектуры:

- [**Saga и распределенные транзакции**](saga.md)
- [**CQRS**](cqrs.md)
- [**Шлюз (Gateway)**](../%D0%91%D0%B0%D0%B7%D0%BE%D0%B2%D1%8B%D0%B5%20%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B%201a0aa0bab3524861858579af05c60be4/%D0%A8%D0%BB%D1%8E%D0%B7%20(Gateway)%209e1eb7be2e4d40a39fbf450b2f474341.md)
- [**Aggregator**](aggregator.md)
- [**Chain**](chain.md)
- [**Branch**](branch.md)
- [**Ambassador**](ambassador.md)

Отмечу, что выбрав Database per service,  паттерны которые я привел выше - придется чаще имплементировать в ваши приложения, тк без их помощи адекватные кросс-сервисные транзакции будет сделать очень сложно.